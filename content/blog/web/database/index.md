---
title: 'Database & SQL'
date: '2019-12-15'
category: 'web'
---

# Database

- Database란 데이터를 저장하는 단순 시스템을 의미한다.

- 기본적으로 우리는 하드 또는 클라우드에 저장한다.
- 데이터를 변수에 저장하면 보존 할수없다(프로그램을 끄면 불러올수없다.)
- 컴퓨터에서는 저장수단은 메모리랑 하드디스크 딱 두가지 뿐이다. 메모리는 빠르다. 하지만 단점은 보존이 되지 않는다(휘발성). data를 영구적 저장하고 싶다면 사용할 수 없다. data를 영구적 사용을 위해서는 메모리 대신 하드디스크 사용해야한다.

- 우리가 파일로 하드에 저장해도 되는데 굳이 데이터베이스를 사용하는이유
- git과 비슷하다. 단순 저장을 떠나서 데이터의 관리를 용이하게 하기위해서 사용한다.
- 검색, 모델링 등 여러가지 효율적인 기능을 위해 사용한다.

- Database는 backend와 물리적으로 다른공간에 있을 수 있고, 대부분 떨어져있다.
- DB의 두가지 형태

### 1. 관계형 DB

- 관계형 DB가 무엇이냐? 말 그대로 데이터를 관계형으로 표시하는 것이다. (사전에 모델링을 짜야되는데, 그 과정에서 서로 관계가 있도록 짜는 것)
- 테이블구조로 진행(Table), 엑셀과 비슷
- 테이블은 column 과 row로 나뉨
- ex > column 필드명 은 id, name, password
- ex > row는 실제 value(2, 아이유, 4567 / 3, 서태지, 7513)
- ex > STOCKS table

```
column:  id   company     price
row:      1    현대       30,000
              2    wecode     40,0000
```

- table이 모인게 DB 그 DB끼리 관계가 있는것이 관계형 DB

  1.1 **One to One**

  - 하나에서 하나로 연결되는 row
  - table 수 2개

    1.2 **One to N**

  - 하나의 row와 다른 여러 row와 연결될수있으면 one to n
  - table 수 2개

    1.3 **N to N**

  - table 수 3개 (테이블과 테이블사이에 테이블을 이어주는 중간테이블이있음 , join테이블)
  - 여러 row와 여러 row가 연결(ex: 책! 한 저자가 여러책을 쓸 수 있고, 한 책에 꼭 한명의 저자가 있는 것은 아니다.)
    저자 ---> 책 <---저자

# 테이블 끼리 연결

- 연결된걸 어떻게 표현하냐? 주로 아이디를 사용.(아이디는 해당 row를 나타내느 특정 고유번호)
- 블로그 참고(그림)
- 데이터의 양이 줄어드는 것도 아닌것 같은데 이용하는 이유

* 데이터의 중복성이 있는 부분을 table로
* 두번째 장점: 데이터의 완정성이 보장됨: 없는 정보가 입력될 확률이 적다.
* 리스트에 값들을 매겨 사용하는 테이블을 normalization Table이라고 한다.
* 근데 왜 하필 id값을 이용해야할까?? vip라는 값을 이용해도 되는데.....??
* 그 이유는 불변성 때문이다. 숫자 1이 변경될 일은 없다, 문자라면 vip에서 vvip로 바꿔야한다.. 1에 넣어두면 vip에서 vvip로 변해도 상관없이 사용할수있다. 문맥과 아무런 상관없는 숫자에 넣어서 연결시킨다. 문맥상 상관없는 num을 키로 사용하는건 => Surrogate Key(대리키) 문맥상 상관있는 vip를 키로 사용하는건 => Natural Key(자연키)

# ACID(Atomicity, Consistency, Isolation, Durability)

- **Atomicity(원자성)**
- 트랜잭션과 관련된 작업들이 부분적으로 실행되다가 중단되지 않는 것을 보장하는 능력
- 예를 들어, 자금 이체는 성공할 수도 실패할 수도 있지만 보내는 쪽에서 돈을 빼 오는 작업만 성공하고 받는 쪽에 돈을 넣는 작업을 실패해서는 안된다.
- 원자성은 이와 같이 중간 단계까지 실행되고 실패하는 일이 없도록 하는 것이다.
- **Consistency(일관성)**
- 트랜잭션이 실행을 성공적으로 완료하면 언제나 일관성 있는 데이터베이스 상태로 유지하는 것을 의미한다.
- 무결성 제약이 모든 계좌는 잔고가 있어야 한다면 이를 위반하는 트랜잭션은 중단된다.
- **Isolation(고립성)**
- 트랜잭션을 수행 시 다른 트랜잭션의 연산 작업이 끼어들지 못하도록 보장하는 것을 의미한다.
- 트랜잭션 밖에 있는 어떤 연산도 중간 단계의 데이터를 볼 수 없음을 의미
- 은행 관리자는 이체 작업을 하는 도중에 쿼리를 실행하더라도 특정 계좌간 이체하는 양 쪽을 볼 수 없다. 공식적으로 고립성은 트랜잭션 실행내역은 연속적이어야 함을 의미한다.
- 성능관련 이유로 인해 이 특성은 가장 유연성 있는 제약 조건이다.
- **Durability(지속성)**
- 성공적으로 수행된 트랜잭션은 영원히 반영되어야 함을 의미한다.
- 시스템 문제, DB 일관성 체크 등을 하더라도 유지되어야 함을 의미한다.
- 전형적으로 모든 트랜잭션은 로그로 남고 시스템 장애 발생 전 상태로 되돌릴 수 있다. 트랜잭션은 로그에 모든 것이 저장된 후에만 commit 상태로 간주될 수 있다.

# Transaction(트랜잭션)

- 일련의 작업들이 마치 하나의 작업처럼 취급되고, 모두 성공하거나 아니면 모두 다 실패하는 것을 이야기한다.
- ex) 잔고확인 -> 해당계좌에서 차감 -> 송금 -> 상대계좌에 입금
- 위의 과정이 모두 통과해야 성공, 송금에서 error가면 트랜잭션을 이용하여 처음으로 돌린다.
- 다성공해야 **commit**, 하나라도 error라면 **rollback**

### 2. 비관계형 DB

- 말그대로 table간의 관계가 없다.
- 관계형과는 다르게 다른 것과 상관없이 어떤 정보이던지 각각 추가할 수 있다.
- 단점 구조가 없다보니 데이터의 온전성이 없고, 중복성이 있을 수 있다.
- 확정성이 좋다.

- 정형화가 되면 관계형 DB, 정형화가 안되면 비관계형 DB

# SQL

- 관계형 데이터베이스를 사용하기 위한 언어
- Structured Query Language: 구조화된 ?? 언어
- CRUD

1. SELECT: 선택
2. INSERT: 생성
3. UPDATE: 수정
4. DELETE: 삭제
5. Exist: 존재를 확인하기 위해
6. Join (가장중요)
7. CREATE TABLE: 테이블 생성
   > https://stackoverflow.com/c/wecode/questions/145

### Join

![SQL_JOIN_0.png](https://images.velog.io/post-images/jotang/3009ac50-21bc-11ea-a1f9-4b865b8b9f69/SQLJOIN0.png)

![sadsadf.JPG](https://images.velog.io/post-images/jotang/4ff6e410-21bc-11ea-a1f9-4b865b8b9f69/sadsadf.JPG)
